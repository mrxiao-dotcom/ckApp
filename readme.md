# 交易系统

## 最近更新 (Recent Changes)

### 2024-12-25
1. 修复了时间显示问题
   - 取消了时间格式化和时区转换
   - 直接显示数据库返回的原始时间字符串

2. 修复了位置字段筛选逻辑
   - 改用直接比较而不是百分比转换
   - 支持范围筛选（最小值-最大值）

3. 修复了监控列表中多空方向字段的显示

4. 优化了监控列表显示
   - 增加了价格字段的显示宽度
   - 调整了数字列的最小宽度

### 2024-12-24
1. 优化了数据格式显示
   - 振幅和位置显示为百分比
   - 成交量使用K/M/B单位显示
   - 数字右对齐，时间居中显示

2. 改进了筛选功能
   - 支持振幅范围筛选
   - 支持成交量范围筛选（单位：百万USDT）
   - 支持按品种名称搜索

## 功能说明

### 1. 时间显示
- 监控列表和品种筛选中的时间字段，直接显示数据库中的原始时间字符串
- 不进行任何时区转换或格式化处理

### 2. 品种筛选功能

#### 2.1 位置字段筛选
- 位置字段支持设置最小值和最大值范围筛选
- 如果不设置，则表示不限制
- 筛选规则：
  - 如果设置最小值（如0.2），则筛选结果中的位置值必须大于等于0.2
  - 如果同时设置最小值和最大值（如0.5-0.8），则筛选结果中的位置值必须在这个范围内
  - 数据库中的 position_ratio 字段值与输入的筛选值直接比较，无需转换

#### 2.2 振幅字段筛选
- 数据库中存储的是小数形式
- 前端显示时需要乘以100并显示百分号
- 筛选时需要将输入值除以100后再与数据库进行比较

#### 2.3 成交量字段筛选
- 输入值单位为百万
- 查询时需要将输入值乘以1000000转换为USDT
- 显示时需要格式化：
  - 大于等于10亿显示为B
  - 大于等于100万显示为M
  - 大于等于1000显示为K

### 3. 监控列表功能
- 显示字段包括：
  - 名称
  - 最新价
  - 更新时间
  - 振幅
  - 位置
  - 方向（多空方向）
  - 配置市值
  - 杠杆
  - 止盈目标
  - 状态
  - 激活状态
  - 同步时间
  - 操作按钮

### 4. 数据格式说明
- 振幅(amplitude)：数据库存储小数，显示时乘以100并加上%
- 位置比(position_ratio)：数据库存储小数，显示时乘以100并加上%
- 成交量(volume_24h)：数据库存储原始USDT金额，显示时需要格式化为K/M/B单位
- 时间字段：直接显示数据库返回的原始格式

### 5. 其他说明
- 所有金额相关的数字右对齐显示
- 所有时间居中显示
- 状态使用不同颜色的标签显示

## 开发环境

### 依赖
- Python 3.8+
- Flask 3.0.0
- SQLAlchemy 2.0.23
- PyMySQL 1.1.0
- 其他依赖见 requirements.txt

### 数据库
- MySQL 5.7+
- 需要配置 config.py 中的数据库连接信息

### 部署
- 支持 Windows 服务
- 支持 Supervisor 进程管理 